<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCLEX Prep Ultimate Edition</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #9b59b6;
            --success: #27ae60;
            --error: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
        }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f6f7; color: var(--dark); margin: 0; padding: 20px; display: flex; justify-content: center; min-height: 100vh; }
        .app-container { background: white; width: 100%; max-width: 900px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); overflow: hidden; display: flex; flex-direction: column; margin-bottom: 50px; }
        header { background: var(--primary); color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .badge { background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 15px; font-size: 0.8rem; }
        .view { padding: 30px; display: none; animation: fadeIn 0.4s ease; }
        .view.active { display: block; }
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px; }
        .menu-card { background: white; border: 2px solid #e0e0e0; border-radius: 10px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.2s; }
        .menu-card:hover { transform: translateY(-3px); border-color: var(--secondary); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .progress-container { height: 6px; background: #eee; width: 100%; }
        .progress-fill { height: 100%; background: var(--secondary); width: 0%; transition: width 0.3s; }
        .question-text { font-size: 1.2rem; font-weight: 600; margin: 20px 0; line-height: 1.5; }
        .option-btn { background: white; border: 2px solid #ddd; padding: 15px; border-radius: 8px; text-align: left; font-size: 1rem; cursor: pointer; width: 100%; margin-bottom: 10px; transition: all 0.2s; }
        .option-btn:hover:not(:disabled) { border-color: var(--secondary); background: #f9f9f9; }
        .option-btn.correct { background: #d4edda !important; border-color: var(--success) !important; color: #155724; }
        .option-btn.wrong { background: #f8d7da !important; border-color: var(--error) !important; color: #721c24; }
        .rationale { background: #e8f4fd; border-left: 5px solid var(--secondary); padding: 15px; margin-top: 20px; border-radius: 4px; display: none; }
        .btn { background: var(--primary); color: white; border: none; padding: 12px 25px; border-radius: 6px; cursor: pointer; font-size: 1rem; margin-top: 20px; }
        .btn:hover { background: var(--secondary); }
        .score-box { text-align: center; margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px; }
        .score-number { font-size: 3rem; font-weight: bold; color: var(--primary); display: block; }
        .rundown-item { border: 1px solid #ddd; border-radius: 8px; margin-bottom: 15px; padding: 15px; background: white; border-left: 6px solid #ccc; }
        .rundown-item.correct { border-left-color: var(--success); }
        .rundown-item.wrong { border-left-color: var(--error); }
        .rundown-q { font-weight: bold; margin-bottom: 10px; display: block; }
        .controls-area { margin-bottom: 20px; display: flex; align-items: center; gap: 10px; background: #eee; padding: 15px; border-radius: 8px; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <h1 id="header-title">NCLEX Prep Ultimate</h1>
        <div class="badge" id="topic-badge">Menu</div>
    </header>

    <div id="view-menu" class="view active">
        <div class="controls-area">
            <input type="checkbox" id="randomize-toggle" checked style="transform: scale(1.5);">
            <label for="randomize-toggle"><strong>Randomize Questions?</strong> (Shuffle order every time)</label>
        </div>
        <div class="menu-grid">
            <div class="menu-card" onclick="startQuiz('gi')">
                <span style="font-size:3rem;">ü©∫</span>
                <h3>GI Disorders</h3>
                <p>100 Questions</p>
                <p style="color:#777; font-size:0.9rem;">GERD, IBD, Liver, Pancreas</p>
            </div>
            <div class="menu-card" onclick="startQuiz('psych')">
                <span style="font-size:3rem;">üß†</span>
                <h3>Psychiatric Nursing</h3>
                <p>80 Questions</p>
                <p style="color:#777; font-size:0.9rem;">Meds, Neuro, Communication</p>
            </div>
        </div>
    </div>

    <div id="view-quiz" class="view">
        <div class="progress-container"><div class="progress-fill" id="progress-fill"></div></div>
        <div style="margin-top:10px; color:#666; font-size:0.9rem; display:flex; justify-content:space-between;">
            <span>Question <span id="q-current">1</span> of <span id="q-total">10</span></span>
            <span id="score-tracker">Score: 0</span>
        </div>
        <div class="question-text" id="question-text"></div>
        <div id="options-container"></div>
        <div class="rationale" id="rationale-display"><strong>Rationale:</strong> <span id="rationale-text"></span></div>
        <div style="text-align:right;"><button class="btn" id="btn-next" onclick="nextQuestion()" style="display:none;">Next Question ‚ûú</button></div>
    </div>

    <div id="view-results" class="view">
        <div class="score-box">
            <h2>Exam Complete</h2>
            <span class="score-number"><span id="final-score">0</span>%</span>
            <p id="final-stats">You answered X out of Y correctly.</p>
            <button class="btn" onclick="showMenu()" style="background:transparent; border:2px solid var(--primary); color:var(--primary);">Return to Menu</button>
        </div>
        <h3>Review Your Answers:</h3>
        <div id="rundown-container"></div>
        <div style="text-align:center; margin-top:30px;"><button class="btn" onclick="window.scrollTo(0,0); showMenu();">Take Another Quiz</button></div>
    </div>
</div>

<script>
    // ================= FULL DATASETS =================
    
    const psychQuestions = [
        { q: "A client with Schizophrenia taking Haloperidol has high fever (39.5¬∞C), muscle rigidity, and tachycardia. Priority action?", options: ["Administer Benztropine.", "Hold med & notify provider immediately.", "Document & monitor.", "Administer acetaminophen."], answer: 1, rationale: "Signs of Neuroleptic Malignant Syndrome (NMS). Immediate withdrawal of the drug is required." },
        { q: "A client on Phenelzine (MAOI) chooses pepperoni pizza. What is the risk?", options: ["Sodium toxicity.", "Diarrhea.", "Hypertensive Crisis.", "Allergic reaction."], answer: 2, rationale: "Pepperoni is high in Tyramine, which interacts with MAOIs causing hypertensive crisis." },
        { q: "Client on Lithium has diarrhea, tremors, and level of 1.6 mEq/L. Interpretation?", options: ["Sub-therapeutic.", "Therapeutic.", "Toxic.", "Expected."], answer: 2, rationale: "Levels >1.5 mEq/L indicate toxicity, especially with GI symptoms." },
        { q: "Client on Clozapine needs monitoring of which lab?", options: ["Liver enzymes.", "WBC & ANC.", "Creatinine.", "Glucose."], answer: 1, rationale: "Risk of Agranulocytosis (fatal drop in WBCs)." },
        { q: "Client on Lithium wants to start a low-sodium diet. Nurse response?", options: ["Good for heart.", "No, low sodium causes toxicity.", "Increase sodium.", "No effect."], answer: 1, rationale: "Low sodium causes kidneys to retain Lithium, leading to toxicity." },
        { q: "Which is NOT a symptom of EPS?", options: ["Akathisia.", "Dystonia.", "Pseudoparkinsonism.", "High fever/Autonomic instability."], answer: 3, rationale: "High fever is NMS, not EPS." },
        { q: "Discharge instruction for Alprazolam (Xanax)?", options: ["Take with wine.", "Stop if sleepy.", "Do not drive initially.", "Takes 4 weeks to work."], answer: 2, rationale: "Benzos cause sedation; safety is priority." },
        { q: "Client on Fluoxetine feels 'jittery'. Explanation?", options: ["Common transient side effect.", "Allergy.", "Stop immediately.", "Take at night."], answer: 0, rationale: "Jitteriness/anxiety is common in the first few weeks of SSRIs." },
        { q: "Client regarding ECT needs further teaching:", options: ["I get anesthesia.", "Memory loss possible.", "Cures depression forever.", "Needs consent."], answer: 2, rationale: "ECT is a treatment, not a permanent cure." },
        { q: "Therapeutic response to: 'I'm terrible, I don't deserve to live.'", options: ["Why?", "You aren't terrible.", "You sound hopeless.", "Let's play cards."], answer: 2, rationale: "Reflecting feelings validates the client." },
        { q: "Goal of Orientation Phase?", options: ["Insight.", "Trust & Contract.", "Resistance.", "Evaluation."], answer: 1, rationale: "Establishing parameters and rapport." },
        { q: "Priority for client saying 'Family better off without me':", options: ["Suicide precautions.", "Journaling.", "Gratitude list.", "Meds."], answer: 0, rationale: "Safety first for suicidal ideation." },
        { q: "Response to personal questions:", options: ["Answer fully.", "Ask why.", "Redirect focus to client.", "Lie."], answer: 2, rationale: "Maintains professional boundaries." },
        { q: "'You are just like my mother!' is:", options: ["Countertransference.", "Transference.", "Resistance.", "Violation."], answer: 1, rationale: "Displacing past feelings onto the nurse." },
        { q: "Non-therapeutic response to 'Should I divorce?':", options: ["Pros and cons?", "I think you should wait.", "Difficult decision.", "How does it feel?"], answer: 1, rationale: "Giving advice ignores autonomy." },
        { q: "Yelling at sibling after failing exam is:", options: ["Projection.", "Displacement.", "Reaction Formation.", "Sublimation."], answer: 1, rationale: "Shifting anger to a safe target." },
        { q: "NOT a criteria for Mental Health (PRAISE):", options: ["Reality.", "Autonomy.", "Absence of stress.", "Mastery."], answer: 2, rationale: "Stress is normal; absence is not realistic." },
        { q: "Maslow priority:", options: ["Spiritual.", "Safety.", "Food/Sleep.", "Esteem."], answer: 2, rationale: "Physiological needs come first." },
        { q: "Bedwetting after new sibling is:", options: ["Repression.", "Regression.", "Reaction Formation.", "Displacement."], answer: 1, rationale: "Returning to earlier developmental stage." },
        { q: "Crisis after typhoon is:", options: ["Maturational.", "Situational.", "Adventitious.", "Internal."], answer: 2, rationale: "Disaster impacting a community." },
        { q: "Erikson stage for 75-year-old:", options: ["Intimacy vs Isolation.", "Generativity vs Stagnation.", "Integrity vs Despair.", "Identity vs Confusion."], answer: 2, rationale: "Reflection on life." },
        { q: "Personality part inducing guilt:", options: ["Id.", "Ego.", "Superego.", "Conscious."], answer: 2, rationale: "Superego is the moral conscience." },
        { q: "Organizing cards (9 y/o) is Piaget stage:", options: ["Sensorimotor.", "Preoperational.", "Concrete Operational.", "Formal."], answer: 2, rationale: "Classification logic appears here." },
        { q: "Boasting group member is:", options: ["Monopolizer.", "Recognition Seeker.", "Harmonizer.", "Gatekeeper."], answer: 1, rationale: "Seeking attention for self." },
        { q: "Parents focusing on son to avoid their conflict:", options: ["Enmeshment.", "Triangulation.", "Scapegoating.", "Double Bind."], answer: 1, rationale: "Using a third party to diffuse tension." },
        { q: "Gradual exposure with relaxation is:", options: ["Flooding.", "Aversion.", "Systematic Desensitization.", "Modeling."], answer: 2, rationale: "Classic phobia treatment." },
        { q: "Drug causing nausea with alcohol is:", options: ["Desensitization.", "Flooding.", "Aversion Therapy.", "Operant."], answer: 2, rationale: "Pairing negative stimulus with behavior." },
        { q: "'Identified Patient' is:", options: ["Problem cause.", "Healthiest.", "Symptom bearer.", "Only one needing help."], answer: 2, rationale: "Reflects family dysfunction." },
        { q: "PH Mental Health Act:", options: ["RA 9165.", "RA 11036.", "RA 7160.", "RA 10354."], answer: 1, rationale: "Republic Act 11036." },
        { q: "Stress seminar for healthy students is:", options: ["Primary.", "Secondary.", "Tertiary.", "Rehab."], answer: 0, rationale: "Prevention before illness." },
        { q: "Impulsivity after head injury indicates damage to:", options: ["Parietal.", "Temporal.", "Frontal.", "Occipital."], answer: 2, rationale: "Frontal lobe controls impulse and personality." },
        { q: "'Emotional brain' is:", options: ["Cerebellum.", "Limbic System.", "RAS.", "Brain Stem."], answer: 1, rationale: "Center for emotion and memory." },
        { q: "Balance/coordination issue suggests:", options: ["Cerebellum.", "Hypothalamus.", "Thalamus.", "Pons."], answer: 0, rationale: "Controls voluntary movement coordination." },
        { q: "Schizophrenia neurotransmitter hypothesis:", options: ["Low Acetylcholine.", "High Dopamine.", "High Serotonin.", "High GABA."], answer: 1, rationale: "Excess dopamine linked to psychosis." },
        { q: "SSRI mechanism:", options: ["Increase Serotonin in synapse.", "Block Serotonin.", "Destroy Serotonin.", "Mimic Dopamine."], answer: 0, rationale: "Blocks reuptake, leaving more available." },
        { q: "Inhibitory neurotransmitter (calming):", options: ["Glutamate.", "Norepinephrine.", "GABA.", "Histamine."], answer: 2, rationale: "GABA reduces neuronal excitability." },
        { q: "PET scan vs CT scan:", options: ["Magnets.", "Function vs Structure.", "Cost.", "No difference."], answer: 1, rationale: "PET shows physiology/function; CT shows anatomy." },
        { q: "Why antidepressants take weeks:", options: ["Neuroplasticity.", "First-pass.", "Receptor adaptation.", "Blood-brain barrier."], answer: 2, rationale: "Receptors must downregulate/sensitize." },
        { q: "Frontal lobe stroke behavior:", options: ["Hearing loss.", "Visual loss.", "Impaired judgment.", "Sensory loss."], answer: 2, rationale: "Executive function is frontal." },
        { q: "Astereognosis (can't identify object by touch) lobe:", options: ["Parietal.", "Occipital.", "Temporal.", "Frontal."], answer: 0, rationale: "Parietal processes tactile info." },
        { q: "Auditory hallucinations lobe:", options: ["Occipital.", "Temporal.", "Cerebellum.", "Stem."], answer: 1, rationale: "Temporal lobe has auditory cortex." },
        { q: "Cortical blindness lobe:", options: ["Frontal.", "Parietal.", "Temporal.", "Occipital."], answer: 3, rationale: "Visual processing center." },
        { q: "Vital sign instability location:", options: ["Brain Stem.", "Corpus Callosum.", "Hippocampus.", "Thalamus."], answer: 0, rationale: "Medulla controls heart/lungs." },
        { q: "Locus Coeruleus neurotransmitter:", options: ["Serotonin.", "Dopamine.", "Norepinephrine.", "Acetylcholine."], answer: 2, rationale: "Stress response source." },
        { q: "Parkinson's degeneration site:", options: ["Substantia Nigra.", "Amygdala.", "Hypothalamus.", "Wernicke's."], answer: 0, rationale: "Dopamine production site." },
        { q: "Hypothalamus function:", options: ["Memory.", "Homeostasis (hunger/temp).", "Logic.", "Muscle."], answer: 1, rationale: "Basic drives regulation." },
        { q: "Encoding new memories:", options: ["Amygdala.", "Hippocampus.", "Thalamus.", "Cingulate."], answer: 1, rationale: "Short-term to long-term storage." },
        { q: "MRI Contraindication:", options: ["Shellfish.", "Pacemaker.", "Lithium.", "Claustrophobia."], answer: 1, rationale: "Magnets affect metal implants." },
        { q: "Donepezil works by:", options: ["Dopamine.", "Serotonin.", "Acetylcholine.", "GABA."], answer: 2, rationale: "Increases Acetylcholine for memory." },
        { q: "Reward pathway neurotransmitter:", options: ["Dopamine.", "Histamine.", "Glutamate.", "Substance P."], answer: 0, rationale: "Pleasure center." },
        { q: "Fight or Flight neurotransmitter:", options: ["GABA.", "Norepinephrine.", "Serotonin.", "Endorphins."], answer: 1, rationale: "Arousal and alertness." },
        { q: "Excitotoxicity cause:", options: ["GABA.", "Glutamate.", "Serotonin.", "Dopamine."], answer: 1, rationale: "Excess excitation kills neurons." },
        { q: "Reuptake definition:", options: ["New chemicals.", "Return to sender.", "Destroyed.", "Muscle binding."], answer: 1, rationale: "Recycling of neurotransmitter." },
        { q: "Low Serotonin associated with:", options: ["Schizophrenia.", "Mania.", "Depression.", "ADHD."], answer: 2, rationale: "Mood regulation." },
        { q: "Blood-Brain Barrier function:", options: ["Prevent blood.", "Protect from toxins.", "Make CSF.", "Connect sides."], answer: 1, rationale: "Filter for brain protection." },
        { q: "Monoamines are:", options: ["Dopamine, Serotonin, NE.", "GABA.", "Glutamate.", "Ach."], answer: 0, rationale: "Class of neurotransmitters." },
        { q: "Sensitization means:", options: ["More responsive.", "Destroyed.", "Blocked.", "Mimics."], answer: 0, rationale: "Up-regulation of response." },
        { q: "Neuroplasticity is:", options: ["Static brain.", "Hardening.", "Reorganization.", "Breakdown."], answer: 2, rationale: "Ability to form new connections." },
        { q: "Why taper meds?", options: ["Rebound effects.", "Refills.", "Antibiotic rule.", "System retention."], answer: 0, rationale: "Prevent withdrawal." },
        { q: "Half-life determines:", options: ["Strength.", "Dosing frequency.", "Weight.", "Cost."], answer: 1, rationale: "Duration of action." },
        { q: "Black Box Warning:", options: ["Illegal.", "Generic.", "Serious risk.", "Adults only."], answer: 2, rationale: "Strict FDA warning." },
        { q: "Depot Injection benefit:", options: ["Faster.", "Steady dose 2-4 wks.", "No side effects.", "Home use."], answer: 1, rationale: "Compliance aid." },
        { q: "Sudden neck spasm (Torticollis) is:", options: ["Akathisia.", "Dystonia.", "Tardive Dyskinesia.", "NMS."], answer: 1, rationale: "Acute muscle spasm." },
        { q: "Akathisia behavior:", options: ["Sleep.", "Pacing/Restlessness.", "Tremor.", "Lip smacking."], answer: 1, rationale: "Internal restlessness." },
        { q: "Irreversible side effect:", options: ["Dystonia.", "Pseudoparkinsonism.", "Tardive Dyskinesia.", "Dry mouth."], answer: 2, rationale: "Permanent movement disorder." },
        { q: "Atypical Antipsychotics block:", options: ["Cheaper.", "Dopamine & Serotonin.", "Serotonin only.", "No side effects."], answer: 1, rationale: "Dual mechanism." },
        { q: "Olanzapine risk:", options: ["Metabolic Syndrome.", "Anorexia.", "Hypothyroid.", "Renal."], answer: 0, rationale: "Weight gain/Diabetes risk." },
        { q: "MAOI + Decongestant risk:", options: ["Drowsy.", "Hypertensive Crisis.", "Cancel out.", "Diarrhea."], answer: 1, rationale: "Sympathomimetic interaction." },
        { q: "TCAs suicide risk:", options: ["Ineffective.", "Cardiac toxicity.", "Insomnia.", "Cost."], answer: 1, rationale: "Lethal in overdose." },
        { q: "Lithium metallic taste/fine tremor:", options: ["Severe toxicity.", "Expected side effect.", "Allergy.", "Low dose."], answer: 1, rationale: "Common; coarse tremor is toxic." },
        { q: "Valproic Acid monitoring:", options: ["Liver.", "Thyroid.", "Kidney.", "Calcium."], answer: 0, rationale: "Hepatotoxicity risk." },
        { q: "Lamotrigine rash:", options: ["Lotion.", "Stop & ER.", "Antihistamine.", "Double dose."], answer: 1, rationale: "Stevens-Johnson Syndrome." },
        { q: "Benzodiazepine neurotransmitter:", options: ["Dopamine.", "Glutamate.", "GABA.", "NE."], answer: 2, rationale: "Increases inhibitory GABA." },
        { q: "Sudden Benzo withdrawal:", options: ["Sleep.", "Seizures.", "Weight gain.", "Dry mouth."], answer: 1, rationale: "Fatal withdrawal risk." },
        { q: "Non-stimulant ADHD med:", options: ["Ritalin.", "Adderall.", "Strattera.", "Modafinil."], answer: 2, rationale: "Norepinephrine reuptake inhibitor." },
        { q: "Ritalin weight loss intervention:", options: ["Liquid diet.", "Give after meals.", "Stop.", "Bedtime."], answer: 1, rationale: "Counteract appetite suppression." },
        { q: "Alcohol + Antidepressant:", options: ["Blocks.", "Potentiates sedation.", "Vomiting.", "Works better."], answer: 1, rationale: "CNS depression synergy." },
        { q: "Pharmacogenomics use:", options: ["Diagnose.", "Predict metabolism.", "IQ.", "Cure."], answer: 1, rationale: "Personalized med selection." }
    ];

    const giQuestions = [
        { q: "PUD patient: rigid, board-like abdomen, shoulder pain. Priority?", options: ["Antacid.", "High-Fowler's.", "Notify Provider.", "Diet history."], answer: 2, rationale: "Signs of perforation/peritonitis. Surgical emergency." },
        { q: "GERD teaching needing correction:", options: ["Wait 2hrs to sleep.", "Small meals.", "Peppermint tea.", "Elevate bed."], answer: 2, rationale: "Peppermint relaxes LES, worsening reflux." },
        { q: "Dumping syndrome symptoms (dizzy/sweating) intervention:", options: ["Fluids.", "Carbs.", "Lie down.", "More carbs."], answer: 2, rationale: "Slows gastric emptying." },
        { q: "Duodenal ulcer pain timing:", options: ["Immediate.", "30-60 min.", "2-3 hrs/Night.", "Lying flat."], answer: 2, rationale: "Pain when stomach is empty." },
        { q: "H. pylori regimen:", options: ["PPI+H2.", "Triple Therapy (2 Abx + PPI).", "Sucralfate.", "Amoxicillin only."], answer: 1, rationale: "Standard eradication protocol." },
        { q: "Pain in RLQ when LLQ palpated:", options: ["Psoas.", "Rovsing's.", "Obturator.", "Rebound."], answer: 1, rationale: "Referred pain sign of appendicitis." },
        { q: "Appendicitis contraindication:", options: ["NPO.", "Ice.", "Enema/Laxative.", "IVF."], answer: 2, rationale: "Risk of rupture due to peristalsis." },
        { q: "Acute Diverticulitis diet:", options: ["High fiber.", "NPO/Clear Liquid.", "Low fat.", "Full liquid."], answer: 1, rationale: "Bowel rest during inflammation." },
        { q: "Peritonitis priority concern:", options: ["Dehydration.", "Septic Shock.", "Ileus.", "Pain."], answer: 1, rationale: "High risk of sepsis." },
        { q: "Diverticulitis pain location:", options: ["RUQ.", "LUQ.", "RLQ.", "LLQ."], answer: 3, rationale: "Sigmoid colon location." },
        { q: "Ulcerative Colitis characteristic:", options: ["Steatorrhea.", "Bloody diarrhea.", "Cobblestone.", "Fistula."], answer: 1, rationale: "Mucosal ulceration causes bleeding." },
        { q: "Crohn's fistula diet:", options: ["Low cal.", "High cal/High protein.", "High fiber.", "Fluid restriction."], answer: 1, rationale: "Promote healing." },
        { q: "IBD anti-inflammatory med:", options: ["Sulfasalazine.", "Omeprazole.", "Lactulose.", "Reglan."], answer: 0, rationale: "5-ASA reduces inflammation." },
        { q: "Toxic Megacolon sign:", options: ["Hyperactive sounds.", "Bradycardia.", "Distension/Absent sounds.", "Bleeding."], answer: 2, rationale: "Paralysis and dilation of colon." },
        { q: "Early obstruction sound:", options: ["Absent.", "High-pitched tinkling.", "Dull.", "Friction rub."], answer: 1, rationale: "Hyper-peristalsis pushing against block." },
        { q: "Small bowel obstruction electrolyte risk:", options: ["Hyperkalemia.", "Hypokalemia.", "Hypercalcemia.", "Hypomagnesemia."], answer: 1, rationale: "Vomiting loses potassium." },
        { q: "Obstruction priority:", options: ["Laxative.", "Fiber.", "NG Tube Decompression.", "Supine."], answer: 2, rationale: "Relieve pressure." },
        { q: "High Ammonia med:", options: ["Vitamin K.", "Lactulose.", "Lasix.", "Beta blocker."], answer: 1, rationale: "Excretes ammonia via stool." },
        { q: "Asterixis assessment:", options: ["Babinski.", "Extend arms/wrists.", "Palpate liver.", "Check skin."], answer: 1, rationale: "Flapping tremor sign." },
        { q: "Sengstaken-Blakemore safety item:", options: ["Extra tube.", "Scissors.", "Saline.", "Clamp."], answer: 1, rationale: "Cut ports if airway blocked." },
        { q: "Paracentesis prep:", options: ["Drink water.", "Void/Empty bladder.", "NPO.", "Lie flat."], answer: 1, rationale: "Prevent bladder puncture." },
        { q: "Cirrhosis bleeding risk lab:", options: ["Low Ammonia.", "High Albumin.", "Prolonged PT/INR.", "High ALT."], answer: 2, rationale: "Lack of clotting factors." },
        { q: "RUQ pain to shoulder after fatty meal:", options: ["Pancreatitis.", "Cholecystitis.", "Gastric Ulcer.", "Appendicitis."], answer: 1, rationale: "Gallbladder attack." },
        { q: "Stop breathing on RUQ palpation:", options: ["Cullen.", "Murphy's.", "McBurney.", "Turner."], answer: 1, rationale: "Gallbladder inflammation sign." },
        { q: "Shoulder pain post-lap chole:", options: ["Bad position.", "CO2 gas.", "Heart attack.", "Nerve damage."], answer: 1, rationale: "Phrenic nerve irritation." },
        { q: "T-Tube care:", options: ["Above waist.", "1000ml output.", "Clamp early.", "Below waist."], answer: 3, rationale: "Gravity drainage." },
        { q: "Specific Pancreatitis lab:", options: ["Amylase.", "Lipase.", "Bilirubin.", "WBC."], answer: 1, rationale: "Most specific to pancreas." },
        { q: "Trousseau's sign in Pancreatitis:", options: ["Hyperkalemia.", "Hypocalcemia.", "Hyperglycemia.", "Hypernatremia."], answer: 1, rationale: "Calcium binds to fats." },
        { q: "Acute Pancreatitis diet:", options: ["High fat.", "NPO.", "High protein.", "Clears."], answer: 1, rationale: "Stop enzyme secretion." },
        { q: "Umbilical bruising:", options: ["Grey Turner.", "Cullen.", "Rovsing.", "Homan."], answer: 1, rationale: "Retroperitoneal bleed." },
        { q: "Colonoscopy prep:", options: ["Heavy meal.", "Red Gatorade.", "GoLYTELY until clear.", "Stop BP meds."], answer: 2, rationale: "Clean bowel essential." },
        { q: "Liver biopsy position:", options: ["Supine.", "Left side.", "Right side.", "High Fowler."], answer: 2, rationale: "Pressure for hemostasis." },
        { q: "Post-EGD fluid check:", options: ["Gas.", "Gag reflex.", "Bowel sounds.", "Alertness."], answer: 1, rationale: "Aspiration risk." },
        { q: "FOBT avoid food:", options: ["Chicken.", "Rice.", "Red Meat.", "Milk."], answer: 2, rationale: "False positive risk." },
        { q: "Post-hemorrhoidectomy pain/stool:", options: ["Antidiarrheal.", "Stool softener.", "Enema.", "High protein."], answer: 1, rationale: "Prevent straining." },
        { q: "Sitz bath temp:", options: ["Boiling.", "Warm.", "Soap.", "Ice."], answer: 1, rationale: "Comfort and healing." },
        { q: "Bulking laxative mechanism:", options: ["Irritation.", "Draws water.", "Absorbs water/mass.", "Lubricates."], answer: 2, rationale: "Mimics fiber." },
        { q: "Cirrhosis vomiting blood:", options: ["Ulcer.", "Varices.", "Hemorrhoids.", "Gastritis."], answer: 1, rationale: "Portal hypertension rupture." },
        { q: "B12 for Gastritis:", options: ["Appetite.", "Lack Intrinsic Factor.", "Constipation.", "H. pylori."], answer: 1, rationale: "Pernicious anemia." },
        { q: "Severe diarrhea acid-base:", options: ["Resp Acidosis.", "Met Alk.", "Met Acidosis.", "Resp Alk."], answer: 2, rationale: "Loss of base." },
        { q: "Vagotomy purpose:", options: ["Remove ulcer.", "Decrease acid.", "Emptying.", "Repair."], answer: 1, rationale: "Cut nerve stimulation." },
        { q: "Diverticulitis perforation sign:", options: ["Constipation.", "Mild cramp.", "Rigid abdomen.", "Hyperactive."], answer: 2, rationale: "Peritonitis." },
        { q: "Hep A transmission:", options: ["Blood.", "Sex.", "Food/Water.", "Autoimmune."], answer: 2, rationale: "Fecal-oral." },
        { q: "Pancreatitis hyperglycemia:", options: ["Candy.", "Islet cell damage.", "Liver.", "Kidney."], answer: 1, rationale: "Insulin production down." },
        { q: "GERD avoid:", options: ["Oatmeal.", "Chocolate.", "Apples.", "Chicken."], answer: 1, rationale: "Relaxes LES." },
        { q: "Clay stool/Dark urine:", options: ["Kidney.", "Stomach.", "Biliary obstruction.", "Colon."], answer: 2, rationale: "No bile in stool." },
        { q: "Hiatal hernia lifestyle:", options: ["Lie down.", "Binder.", "Avoid lifting/straining.", "Large meals."], answer: 2, rationale: "Reduce pressure." },
        { q: "Fecal odor emesis:", options: ["Low obstruction.", "Hygiene.", "Cancer.", "Ulcer."], answer: 0, rationale: "Backflow from colon." },
        { q: "Protein in IBD vs Cirrhosis:", options: ["Constipation.", "Healing vs Ammonia.", "Ulcers.", "Allergy."], answer: 1, rationale: "Healing needs protein; Liver fails to detox it." },
        { q: "Cholecystitis NPO why?", options: ["Aspiration.", "Stop gallbladder contraction.", "Diarrhea.", "Prep."], answer: 1, rationale: "Stop pain." },
        { q: "Barrett's Esophagus is:", options: ["Stricture.", "Precancerous.", "Abscess.", "Tear."], answer: 1, rationale: "Cellular change." },
        { q: "Sucralfate timing:", options: ["With meals.", "1hr Before meals.", "After.", "PRN."], answer: 1, rationale: "Coats stomach." },
        { q: "Coffee ground emesis:", options: ["Hematochezia.", "Melena.", "Hematemesis.", "Steatorrhea."], answer: 2, rationale: "Digested blood." },
        { q: "Octreotide action:", options: ["Neutralize.", "Insulin.", "Slow gastric emptying.", "Coat."], answer: 2, rationale: "For dumping syndrome." },
        { q: "Gastric vs Duodenal:", options: ["Weight gain.", "Relieved by food.", "Night pain.", "Pain with food."], answer: 3, rationale: "Gastric hurts with eating." },
        { q: "NSAID ulcer cause:", options: ["H. pylori.", "Inhibit prostaglandins.", "Acid.", "Relax LES."], answer: 1, rationale: "Protective barrier lost." },
        { q: "Dumping syndrome food:", options: ["Pancakes.", "Protein/Veg.", "Pasta.", "Sugar."], answer: 1, rationale: "Avoid carbs/sugar." },
        { q: "Appendicitis WBC 16k:", options: ["Sepsis.", "Leukocytosis.", "Normal.", "Viral."], answer: 1, rationale: "Infection sign." },
        { q: "Obturator sign:", options: ["Extend thigh.", "Rotate flexed thigh.", "Palpate.", "Cough."], answer: 1, rationale: "Appendicitis check." },
        { q: "Peritonitis Semi-Fowler:", options: ["Drain to pelvis.", "Sores.", "Pain.", "Cardiac."], answer: 0, rationale: "Protect lungs." },
        { q: "Diverticulosis prevention:", options: ["Low residue.", "High fiber.", "Antibiotics.", "No activity."], answer: 1, rationale: "Prevent constipation." },
        { q: "Diverticulitis antibiotic:", options: ["Vanc.", "Metronidazole.", "Acyclovir.", "Prednisone."], answer: 1, rationale: "Anaerobes." },
        { q: "Appendicitis heat pad?", options: ["Masks.", "Rupture risk.", "Burns.", "Spasm."], answer: 1, rationale: "Increases flow/pressure." },
        { q: "Transmural IBD:", options: ["UC.", "Crohn's.", "Diverticulitis.", "IBS."], answer: 1, rationale: "Full thickness." },
        { q: "Crohn's steatorrhea:", options: ["Bleeding.", "Malabsorption.", "Bile.", "Emptying."], answer: 1, rationale: "Small bowel issue." },
        { q: "UC curative surgery:", options: ["Resection.", "Proctocolectomy.", "Appy.", "Nissen."], answer: 1, rationale: "Remove colon." },
        { q: "Steroid side effect:", options: ["Hypoglycemia.", "Weight loss.", "Infection.", "Hypotension."], answer: 2, rationale: "Immune suppression." },
        { q: "Smoking in Crohn's:", options: ["Protective.", "No effect.", "Worsens.", "Lungs only."], answer: 2, rationale: "Risk factor." },
        { q: "Fistula definition:", options: ["Telescope.", "Tunnel.", "Block.", "Vein."], answer: 1, rationale: "Abnormal connection." },
        { q: "Volvulus:", options: ["Twisting.", "Telescoping.", "Tumor.", "Paralysis."], answer: 0, rationale: "Bowel twist." },
        { q: "NG tube stopped:", options: ["Remove.", "Irrigate.", "Notify.", "Suction up."], answer: 1, rationale: "Check patency." },
        { q: "High obstruction acid-base:", options: ["Loss of bicarb.", "Loss of acid (Alk).", "CO2.", "Renal."], answer: 1, rationale: "Vomiting acid." },
        { q: "Adhesiolysis:", options: ["Tumor.", "Cut scar tissue.", "Tube.", "Appy."], answer: 1, rationale: "Treats obstruction." },
        { q: "Faint/No stool post-hemorrhoidectomy:", options: ["Constipation.", "Internal bleed.", "Gas.", "Anesthesia."], answer: 1, rationale: "Blood in rectum." },
        { q: "Tucks pads ingredient:", options: ["Lidocaine.", "Witch Hazel.", "Steroid.", "Menthol."], answer: 1, rationale: "Astringent." },
        { q: "Hemorrhoid prevention:", options: ["Enemas.", "Avoid sitting.", "Low residue.", "Limit fluid."], answer: 1, rationale: "Reduce pressure." },
        { q: "Spider angiomas cause:", options: ["Ammonia.", "Estrogen.", "HTN.", "Vit K."], answer: 1, rationale: "Liver can't clear hormones." },
        { q: "Cirrhosis drug toxicity:", options: ["Kidney.", "Metabolism fail.", "Dehydration.", "Protein."], answer: 1, rationale: "Liver clears drugs." },
        { q: "Ascites breathing:", options: ["Oxygen.", "High Fowler.", "Intubate.", "Side."], answer: 1, rationale: "Drop diaphragm." },
        { q: "Liver biopsy clotting check:", options: ["Anemia.", "Bleeding risk.", "Infection.", "Platelets."], answer: 1, rationale: "Liver makes factors." },
        { q: "Encephalopathy sedatives:", options: ["HTN.", "Liver can't break down.", "Ammonia.", "Lactulose."], answer: 1, rationale: "Worsens coma." },
        { q: "ERCP assessment:", options: ["Urine.", "Gag reflex.", "Pulses.", "Pupils."], answer: 1, rationale: "Airway safety." },
        { q: "Autodigestion:", options: ["Stomach.", "Enzymes activate inside.", "Liver.", "Bacteria."], answer: 1, rationale: "Pancreatitis path." },
        { q: "Hypocalcemia sign:", options: ["Chvostek.", "Murphy.", "McBurney.", "Cullen."], answer: 0, rationale: "Facial twitch." },
        { q: "Morphine in Pancreatitis:", options: ["No.", "Yes/Effective.", "Fever.", "Cure."], answer: 1, rationale: "Standard care." },
        { q: "Clay stool meaning:", options: ["Gallbladder.", "Obstruction.", "Bleed.", "Healing."], answer: 1, rationale: "No bile." },
        { q: "5 Fs:", options: ["Forty, Female, Fat, Fertile, Fair.", "Fifty...", "Fit...", "Fever..."], answer: 0, rationale: "Risk factors." },
        { q: "Low fat for gallbladder:", options: ["Constipation.", "Stop contraction.", "Acid.", "Liver."], answer: 1, rationale: "Reduce pain." },
        { q: "Barium fluids:", options: ["Limit.", "Plenty/Flush.", "Hot.", "No dairy."], answer: 1, rationale: "Prevent impaction." },
        { q: "Colonoscopy reach:", options: ["Rectum.", "Sigmoid.", "Cecum.", "Duodenum."], answer: 2, rationale: "Full colon." },
        { q: "Abd assessment order:", options: ["Palpate first.", "Inspect, Palp, Perc, Ausc.", "Inspect, Ausc, Perc, Palp.", "Ausc first."], answer: 2, rationale: "Don't disturb sounds." },
        { q: "Tinkling sounds:", options: ["Normal.", "Ileus.", "Early obstruction.", "Peritonitis."], answer: 2, rationale: "Bowel struggle." },
        { q: "O&P checks:", options: ["Blood.", "Worms/Eggs.", "Fat.", "Bacteria."], answer: 1, rationale: "Parasites." },
        { q: "Ascaris is:", options: ["Bacteria.", "Worm.", "Virus.", "Fungus."], answer: 1, rationale: "Parasite." },
        { q: "Icteric phase sign:", options: ["Flu.", "Jaundice.", "Recovery.", "Ascites."], answer: 1, rationale: "Yellowing." },
        { q: "Fetor Hepaticus:", options: ["Breath odor.", "Tremor.", "Rash.", "Mental."], answer: 0, rationale: "Musty breath." },
        { q: "Atropine use:", options: ["Bradycardia.", "Sedate.", "Vomit.", "Allergy."], answer: 0, rationale: "Vagal response." },
        { q: "Rebound tenderness:", options: ["Gallbladder.", "Appendicitis.", "Gastritis.", "Kidney."], answer: 1, rationale: "Peritoneal inflammation." },
        { q: "Pancreatitis glucose:", options: ["Meds.", "Insulin.", "Glucagon.", "Tabs."], answer: 1, rationale: "Replace insulin." },
        { q: "Hep vaccines:", options: ["C/D.", "A/B.", "E/C.", "B only."], answer: 1, rationale: "Prevention." }
    ];

    // ================= APP LOGIC =================
    let activeDeck = [];
    let currentIdx = 0;
    let score = 0;
    let isAnswered = false;
    let userHistory = [];

    function showView(viewId) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
        window.scrollTo(0,0);
    }

    function showMenu() {
        showView('view-menu');
        document.getElementById('header-title').innerText = "NCLEX Prep Ultimate";
        document.getElementById('topic-badge').innerText = "Menu";
        document.querySelector('header').style.background = "var(--primary)";
    }

    function startQuiz(topic) {
        let sourceDeck = (topic === 'gi') ? [...giQuestions] : [...psychQuestions];
        const themeColor = (topic === 'gi') ? "var(--secondary)" : "var(--accent)";
        const title = (topic === 'gi') ? "GI Disorders" : "Psychiatric Nursing";

        if (document.getElementById('randomize-toggle').checked) {
            sourceDeck.sort(() => Math.random() - 0.5);
        }
        activeDeck = sourceDeck;
        
        document.getElementById('header-title').innerText = title;
        document.getElementById('topic-badge').innerText = "Quiz Active";
        document.querySelector('header').style.background = themeColor;

        currentIdx = 0; score = 0; userHistory = [];
        showView('view-quiz');
        loadQuestion();
    }

    function loadQuestion() {
        isAnswered = false;
        const qData = activeDeck[currentIdx];
        document.getElementById('q-current').innerText = currentIdx + 1;
        document.getElementById('q-total').innerText = activeDeck.length;
        document.getElementById('score-tracker').innerText = `Score: ${score}`;
        document.getElementById('question-text').innerText = qData.q;
        document.getElementById('progress-fill').style.width = ((currentIdx) / activeDeck.length) * 100 + '%';
        
        document.getElementById('rationale-display').style.display = 'none';
        document.getElementById('btn-next').style.display = 'none';
        
        const optContainer = document.getElementById('options-container');
        optContainer.innerHTML = '';
        qData.options.forEach((optText, index) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = optText;
            btn.onclick = () => handleAnswer(index, btn);
            optContainer.appendChild(btn);
        });
    }

    function handleAnswer(selectedIndex, btnElement) {
        if (isAnswered) return;
        isAnswered = true;
        const currentQ = activeDeck[currentIdx];
        const correctIndex = currentQ.answer;
        const isCorrect = (selectedIndex === correctIndex);
        
        const allBtns = document.getElementById('options-container').children;
        if (isCorrect) { btnElement.classList.add('correct'); score++; }
        else { btnElement.classList.add('wrong'); allBtns[correctIndex].classList.add('correct'); }

        userHistory.push({ q: currentQ.q, user: currentQ.options[selectedIndex], correct: currentQ.options[correctIndex], isCorrect: isCorrect, rationale: currentQ.rationale });

        document.getElementById('rationale-text').innerText = currentQ.rationale;
        document.getElementById('rationale-display').style.display = 'block';
        document.getElementById('btn-next').style.display = 'inline-block';
        document.getElementById('score-tracker').innerText = `Score: ${score}`;
        for (let btn of allBtns) btn.disabled = true;
    }

    function nextQuestion() {
        currentIdx++;
        if (currentIdx < activeDeck.length) loadQuestion();
        else finishQuiz();
    }

    function finishQuiz() {
        showView('view-results');
        document.getElementById('final-score').innerText = Math.round((score / activeDeck.length) * 100);
        document.getElementById('final-stats').innerText = `You answered ${score} out of ${activeDeck.length} correctly.`;
        
        const rundown = document.getElementById('rundown-container');
        rundown.innerHTML = '';
        userHistory.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = `rundown-item ${item.isCorrect ? 'correct' : 'wrong'}`;
            div.innerHTML = `<span class="rundown-q">Q${index + 1}: ${item.q}</span>
                <div style="font-size:0.9rem;">Your Answer: <strong>${item.user}</strong> ${item.isCorrect ? '‚úÖ' : '‚ùå'}</div>
                ${!item.isCorrect ? `<div style="font-size:0.9rem; color:var(--success);">Correct: <strong>${item.correct}</strong></div>` : ''}
                <div style="margin-top:8px; font-size:0.85rem; color:#666; background:#f9f9f9; padding:8px; border-radius:4px;"><strong>Rationale:</strong> ${item.rationale}</div>`;
            rundown.appendChild(div);
        });
    }
</script>
</body>
</html>
